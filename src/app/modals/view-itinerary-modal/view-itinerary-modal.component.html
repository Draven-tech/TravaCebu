<ion-header>
  <ion-toolbar color="warning">
    <ion-title>Itinerary Details</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="close()" fill="clear">
        <ion-icon name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="event-detail-content">
  <div class="itinerary-container">
    <div *ngFor="let day of itinerary" class="day-section">
      <!-- Day Header -->
      <div class="day-header">
        <h2>Day {{ day.day }}</h2>
        <p class="date">{{ getDateDisplay(day.date) }}</p>
      </div>

      <!-- Tourist Spots -->
      <div *ngIf="day.spots && day.spots.length > 0" class="section">
        <h3>Tourist Spots</h3>
                 <div class="spots-list">
           <div *ngFor="let spot of sortByTimeSlot(day.spots); let i = index" class="spot-card">
            <div class="spot-header">
              <span class="spot-number">{{ i + 1 }}.</span>
              <span class="spot-name">{{ spot.name }}</span>

            </div>
            <div class="spot-details">
              <div class="time-duration">
                <ion-icon name="time-outline"></ion-icon>
                <span>{{ getTimeDisplay(day.date + 'T' + spot.timeSlot) }}</span>
                <ion-icon name="timer-outline"></ion-icon>
                <span>{{ spot.estimatedDuration }}</span>
              </div>
              <p *ngIf="spot.description" class="description">{{ spot.description }}</p>
              
              <!-- Show chosen restaurant if this spot has a meal type -->
              <div *ngIf="spot.mealType && spot.chosenRestaurant" class="chosen-restaurant">
                <div class="restaurant-header">
                  <span class="meal-type">{{ spot.mealType | titlecase }}</span>
                </div>
                <div class="restaurant-card">
                  <h4>{{ spot.chosenRestaurant.name }}</h4>
                  <p *ngIf="spot.chosenRestaurant.rating" class="rating">
                    {{ spot.chosenRestaurant.rating }}
                  </p>
                  <p *ngIf="spot.chosenRestaurant.vicinity" class="address">
                    {{ spot.chosenRestaurant.vicinity }}
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Standalone Restaurants -->
      <div *ngIf="day.restaurants && day.restaurants.length > 0" class="section">
        <h3>Restaurants</h3>
                 <div class="restaurants-list">
           <div *ngFor="let restaurant of sortByTimeSlot(day.restaurants)" class="restaurant-card">
            <div class="restaurant-header">
              <h4>{{ restaurant.name }}</h4>
              <span class="time">{{ getTimeDisplay(day.date + 'T' + restaurant.timeSlot) }}</span>
            </div>
            <div class="restaurant-details">
              <p *ngIf="restaurant.description" class="description">{{ restaurant.description }}</p>
              <p class="duration">{{ restaurant.estimatedDuration }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Chosen Hotel -->
      <div *ngIf="day.chosenHotel" class="section">
        <h3>Accommodation</h3>
        <div class="hotel-card">
          <div class="hotel-header">
            <h4>{{ day.chosenHotel.name }}</h4>
            <span class="check-in">Check-in: Evening</span>
          </div>
          <div class="hotel-details">
            <p *ngIf="day.chosenHotel.rating" class="rating">
              {{ day.chosenHotel.rating }}
            </p>
            <p *ngIf="day.chosenHotel.vicinity" class="address">
              {{ day.chosenHotel.vicinity }}
            </p>
            <p *ngIf="day.chosenHotel.description" class="description">
              {{ day.chosenHotel.description }}
            </p>
          </div>
        </div>
      </div>

      <!-- Standalone Hotels -->
      <div *ngIf="day.hotels && day.hotels.length > 0 && !day.chosenHotel" class="section">
        <h3>Hotels</h3>
                 <div class="hotels-list">
           <div *ngFor="let hotel of sortByTimeSlot(day.hotels)" class="hotel-card">
            <div class="hotel-header">
              <h4>{{ hotel.name }}</h4>
              <span class="time">{{ getTimeDisplay(day.date + 'T' + hotel.timeSlot) }}</span>
            </div>
            <div class="hotel-details">
              <p *ngIf="hotel.description" class="description">{{ hotel.description }}</p>
              <p class="duration">{{ hotel.estimatedDuration }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- No Itinerary Data -->
    <div *ngIf="!itinerary || itinerary.length === 0" class="no-data">
      <h3>No Itinerary Data</h3>
      <p>This itinerary doesn't contain any saved data.</p>
    </div>
  </div>
</ion-content> 