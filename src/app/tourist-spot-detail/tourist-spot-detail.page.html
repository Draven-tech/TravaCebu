<ion-header>
  <ion-toolbar color="warning">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/user-dashboard"></ion-back-button>
    </ion-buttons>
    <ion-title>Tourist Spot Details</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content *ngIf="spotData">
  <img [src]="spotData.img || 'assets/placeholder.jpg'" style="width: 100%; height: 200px; object-fit: cover;" />

  <ion-card>
    <ion-card-header>
      <ion-card-title>{{ spotData.name }}</ion-card-title>
      <ion-card-subtitle>{{ spotData.category }}</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <p>{{ spotData.description }}</p>
      <p><strong>Latitude:</strong> {{ spotData.location?.lat }}</p>
      <p><strong>Longitude:</strong> {{ spotData.location?.lng }}</p>
    </ion-card-content>
  </ion-card>



  <!-- Add Review Form -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Add Your Review</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-item>
        <ion-label position="stacked">Rating (1 to 5)</ion-label>
        <ion-range min="1" max="5" step="1" snaps="true" [(ngModel)]="rating">
          <ion-label slot="end">{{ rating }}</ion-label>
        </ion-range>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Comment</ion-label>
        <ion-textarea [(ngModel)]="comment" placeholder="Share your experience..."></ion-textarea>
      </ion-item>
      <ion-item>
        <ion-label position="stacked">Upload Photo (optional)</ion-label>
        <input type="file" (change)="onFileSelected($event)" accept="image/*" />
      </ion-item>
      
      <ion-img *ngIf="selectedFilePreview" [src]="selectedFilePreview" style="margin: 10px; border-radius: 8px;"></ion-img>
      
      <ion-button expand="full" color="warning" (click)="addReview()" [disabled]="uploading">
        {{ uploading ? 'Uploading...' : 'Submit Review' }}
      </ion-button>
      
      <!-- Reviews Section -->
<h3 class="review-section-title">Reviews</h3>

<div *ngIf="reviews.length > 0; else noReviewsTemplate">
  <ion-card *ngFor="let review of reviews" class="review-card">
    <ion-card-header>
      <ion-card-title>{{ review.username }}</ion-card-title>
      <ion-card-subtitle>Rating: {{ review.rating }}</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <p>{{ review.comment }}</p>
      <ion-img *ngIf="review.photoUrl" [src]="review.photoUrl" class="review-img"></ion-img>
    </ion-card-content>
  </ion-card>
</div>

<ng-template #noReviewsTemplate>
  <ion-card class="review-card">
    <ion-card-header>
      <ion-card-title>Reviews</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-text color="medium">
        <p class="no-reviews-text">No reviews yet. Be the first to leave one!</p>
      </ion-text>
    </ion-card-content>
  </ion-card>
</ng-template>

    </ion-card-content>
  </ion-card>
</ion-content>
